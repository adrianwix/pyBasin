
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Basin stability estimation for dynamical systems">
      
      
        <meta name="author" content="Adrian Wix">
      
      
      
        <link rel="prev" href="../custom-feature-extractor/">
      
      
        <link rel="next" href="../../case-studies/overview/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Dynamics-Based Clustering - pyBasin Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dynamics-based-clustering" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyBasin Documentation" class="md-header__button md-logo" aria-label="pyBasin Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyBasin Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dynamics-Based Clustering
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/adrianwix/pyBasin" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    adrianwix/pyBasin
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../user-guide/bse-overview/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../case-studies/overview/" class="md-tabs__link">
          
  
  
  Case Studies

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../benchmarks/overview/" class="md-tabs__link">
          
  
  
  Benchmarks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/basin-stability-estimator/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/contributing/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyBasin Documentation" class="md-nav__button md-logo" aria-label="pyBasin Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pyBasin Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/adrianwix/pyBasin" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    adrianwix/pyBasin
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Basin Stability Estimator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Basin Stability Estimator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/bse-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview & Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/adaptive-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adaptive Parameter Studies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/samplers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Samplers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solvers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/feature-extractors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Extractors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/feature-selectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Selectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/predictors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Predictors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/plotters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" checked>
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    How To
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            How To
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unbounded-trajectories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handling Unbounded Trajectories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchode-solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TorchODE Solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type-safety-generics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type Safety and Generics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-feature-extractor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Feature Extractor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Dynamics-Based Clustering
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Dynamics-Based Clustering
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-use-this" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use This
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-feature-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Required Feature Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Full Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-0-drift-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 0: Drift Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-1-attractor-type-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 1: Attractor Type Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-2-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 2: Sub-classification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stage 2: Sub-classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fixed-point-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed Point Sub-classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit-cycle-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Limit Cycle Sub-classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaos-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Chaos Sub-classification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constructor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Constructor Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Tuning Tips
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-results" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Results
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Case Studies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Case Studies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/pendulum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pendulum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/duffing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Duffing Oscillator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/lorenz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lorenz System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/friction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Friction Oscillator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../case-studies/rossler-network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RÃ¶ssler Network
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Benchmarks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/basin-stability-estimator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basin Stability Estimator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/end-to-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    End-to-End Performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solver Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmarks/feature-extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Extraction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/basin-stability-estimator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasinStabilityEstimator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/template-integrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TemplateIntegrator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/adaptive-sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasinStabilityStudy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/samplers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Samplers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solvers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solvers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_7" >
        
          
          <label class="md-nav__link" for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Feature Extraction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            Feature Extraction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/feature-extractors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Extractors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/torch-feature-calculators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Torch Feature Calculators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/feature-selector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/predictors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Predictors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plotters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-use-this" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use This
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-feature-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Required Feature Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Full Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-0-drift-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 0: Drift Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-1-attractor-type-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 1: Attractor Type Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stage-2-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Stage 2: Sub-classification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stage 2: Sub-classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fixed-point-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed Point Sub-classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit-cycle-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Limit Cycle Sub-classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaos-sub-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Chaos Sub-classification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constructor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Constructor Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Tuning Tips
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-results" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Results
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/adrianwix/pyBasin/raw/main/guides/dynamics-based-clustering.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="dynamics-based-clustering">Dynamics-Based Clustering</h1>
<h2 id="overview">Overview</h2>
<p>Standard clustering predictors like <a href="../../api/predictors/"><code>HDBSCANClusterer</code></a> group trajectories purely by statistical similarity in feature space. This works well when attractors produce visibly different feature distributions, but it has no awareness of what the features <em>mean</em> physically. A fixed point, a limit cycle, and a chaotic attractor might overlap in some statistical features yet differ fundamentally in their dynamics.</p>
<p><a href="../../api/predictors/"><code>DynamicalSystemClusterer</code></a> takes a different approach: a two-stage hierarchical classification that first identifies the <em>type</em> of attractor (fixed point, limit cycle, or chaos) and then sub-classifies within each type. Because Stage 1 uses physics-based heuristics -- variance thresholds, periodicity measures, drift detection -- it can separate attractors that generic clustering merges.</p>
<p>This guide covers the full setup: the required feature configuration, the clusterer itself, how the two stages work, and tuning advice.</p>
<h2 id="when-to-use-this">When to Use This</h2>
<p>Reach for dynamics-based clustering when:</p>
<ul>
<li>The system has multiple attractor types (e.g., fixed points coexisting with limit cycles)</li>
<li>Generic clusterers merge attractors that differ in dynamical character but overlap in simple statistics</li>
<li>You want physically interpretable labels like <code>FP_0</code>, <code>LC_1</code>, <code>chaos_0</code> rather than opaque integer IDs</li>
</ul>
<p>Standard <a href="../../api/predictors/"><code>HDBSCANClusterer</code></a> or <a href="../../api/predictors/"><code>DBSCANClusterer</code></a> remain better choices for exploratory analysis where attractor types are unknown, or for systems where all attractors are of the same type (e.g., multiple fixed points that only differ in location).</p>
<h2 id="required-feature-configuration">Required Feature Configuration</h2>
<p><code>DynamicalSystemClusterer</code> reads specific features by name. It expects feature names following the <code>state_X__feature_name</code> convention, and it requires these seven base features to be present for at least one state variable:</p>
<table>
<thead>
<tr>
<th>Required feature</th>
<th>What it provides to the clusterer</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>variance</code></td>
<td>Fixed point detection (near-zero variance = FP)</td>
</tr>
<tr>
<td><code>amplitude</code></td>
<td>Limit cycle sub-classification by oscillation size</td>
</tr>
<tr>
<td><code>mean</code></td>
<td>Spatial location for FP and chaos sub-classification</td>
</tr>
<tr>
<td><code>linear_trend__attr_slope</code></td>
<td>Drift detection -- identifies rotating solutions</td>
</tr>
<tr>
<td><code>autocorrelation_periodicity__output_strength</code></td>
<td>Periodicity strength [0, 1] for LC detection</td>
</tr>
<tr>
<td><code>autocorrelation_periodicity__output_period</code></td>
<td>Dominant period for LC sub-grouping</td>
</tr>
<tr>
<td><code>spectral_frequency_ratio</code></td>
<td>Period-n detection (period-1 vs period-2 limit cycles, etc.)</td>
</tr>
</tbody>
</table>
<p>The <code>DYNAMICAL_SYSTEM_FC_PARAMETERS</code> preset in <code>pybasin.ts_torch.settings</code> produces exactly these features. It yields 7 feature columns per state variable (since <code>autocorrelation_periodicity</code> generates two outputs: strength and period). The preset is defined as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DYNAMICAL_SYSTEM_FC_PARAMETERS</span><span class="p">:</span> <span class="n">FCParameters</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s2">&quot;variance&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="s2">&quot;amplitude&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="s2">&quot;linear_trend&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;attr&quot;</span><span class="p">:</span> <span class="s2">&quot;slope&quot;</span><span class="p">}],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="s2">&quot;autocorrelation_periodicity&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="p">{</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="s2">&quot;strength&quot;</span><span class="p">},</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="p">{</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="s2">&quot;period&quot;</span><span class="p">},</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="s2">&quot;spectral_frequency_ratio&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">}</span>
</code></pre></div>
<p>For a 2D system, this produces 14 feature columns -- <code>state_0__variance</code>, <code>state_0__amplitude</code>, ..., <code>state_1__spectral_frequency_ratio</code>. A 3D system like Lorenz would yield 21. See the <a href="../../api/feature-extractors/"><code>TorchFeatureExtractor</code></a> API for details on feature naming and extraction.</p>
<h2 id="full-setup">Full Setup</h2>
<p>Both the feature extractor and the predictor must be configured together. The extractor must produce the features the clusterer expects:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pybasin.basin_stability_estimator</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasinStabilityEstimator</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pybasin.ts_torch.torch_feature_extractor</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchFeatureExtractor</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pybasin.predictors</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicalSystemClusterer</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pybasin.ts_torch.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">DYNAMICAL_SYSTEM_FC_PARAMETERS</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># Feature extractor with the required feature set</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">extractor</span> <span class="o">=</span> <span class="n">TorchFeatureExtractor</span><span class="p">(</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">features</span><span class="o">=</span><span class="n">DYNAMICAL_SYSTEM_FC_PARAMETERS</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">time_steady</span><span class="o">=</span><span class="mf">800.0</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># recommended -- keeps variance thresholds interpretable</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="p">)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="c1"># The dynamics-based clusterer with default parameters</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="n">predictor</span> <span class="o">=</span> <span class="n">DynamicalSystemClusterer</span><span class="p">()</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="c1"># Wire both into the estimator</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">bse</span> <span class="o">=</span> <span class="n">BasinStabilityEstimator</span><span class="p">(</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="n">n</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="n">ode_system</span><span class="o">=</span><span class="n">ode_system</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="n">feature_extractor</span><span class="o">=</span><span class="n">extractor</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>    <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span><span class="p">,</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="p">)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="n">bs_vals</span> <span class="o">=</span> <span class="n">bse</span><span class="o">.</span><span class="n">estimate_bs</span><span class="p">()</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c1"># Labels will be like: {&quot;FP_0&quot;: 0.35, &quot;LC_0&quot;: 0.45, &quot;LC_1&quot;: 0.15, &quot;chaos_0&quot;: 0.05}</span>
</code></pre></div>
<p>The <a href="../../api/basin-stability-estimator/"><code>BasinStabilityEstimator</code></a> automatically calls <code>set_feature_names()</code> on the clusterer before prediction, so there is no manual wiring step for feature names.</p>
<div class="admonition warning">
<p class="admonition-title">Mismatched features</p>
</div>
<p>If the feature extractor does not produce the required features, <code>DynamicalSystemClusterer</code> raises a <code>ValueError</code> at classification time listing which features are missing. The <code>DYNAMICAL_SYSTEM_FC_PARAMETERS</code> preset is the simplest way to guarantee compatibility.</p>
<div class="admonition tip">
<p class="admonition-title">Normalization</p>
</div>
<p>Setting <code>normalize=False</code> on the feature extractor is recommended when using <code>DynamicalSystemClusterer</code>. The default thresholds (<code>fp_variance_threshold=1e-6</code>, etc.) are calibrated for raw, unnormalized feature values. With normalization enabled, variance gets z-score scaled and the thresholds would need manual adjustment.</p>
<h2 id="algorithm">Algorithm</h2>
<p>The classification proceeds in three stages: drift detection (Stage 0), attractor type assignment (Stage 1), and sub-classification within each type (Stage 2). The final output is a label array where each trajectory receives a string label like <code>FP_0</code>, <code>LC_2</code>, or <code>chaos_1</code>.</p>
<h3 id="stage-0-drift-detection">Stage 0: Drift Detection</h3>
<p>Before any classification, the clusterer scans for <em>drifting dimensions</em> -- state variables where a significant fraction of trajectories show monotonic trends. A rotating pendulum is the canonical example: the angle variable increases without bound even though the underlying attractor (continuous rotation) is well-defined.</p>
<p>The detection works as follows. For each state dimension <span class="arithmatex">\(i\)</span>, the clusterer reads the <code>linear_trend__attr_slope</code> feature and computes the fraction of trajectories whose absolute slope exceeds <code>drift_threshold</code> (i.e., <span class="arithmatex">\(|\text{slope}_i| &gt; \texttt{drift_threshold}\)</span>). If more than 30% (<code>drift_fraction=0.3</code>) of trajectories in that dimension have a high slope, dimension <span class="arithmatex">\(i\)</span> is flagged as drifting. All subsequent variance and mean calculations for FP and chaos classification exclude drifting dimensions, since their variance is inflated by the drift rather than by genuine attractor dynamics.</p>
<p>If <em>all</em> dimensions are drifting, the clusterer falls back to using all of them to avoid discarding all information.</p>
<h3 id="stage-1-attractor-type-classification">Stage 1: Attractor Type Classification</h3>
<p>Every trajectory is assigned exactly one of three types: FP, LC, or chaos. The <code>tiers</code> parameter controls which types are active and in what priority order. The default is <code>["FP", "LC", "chaos"]</code>, meaning FP is checked first, then LC, and anything unmatched falls into chaos.</p>
<p>Three aggregate features are computed per trajectory before the tier checks:</p>
<ul>
<li><strong>Variance:</strong> the mean of per-dimension <code>variance</code> values across non-drifting dimensions only.</li>
<li><strong>Periodicity strength:</strong> the <code>autocorrelation_periodicity__output_strength</code> value from the first non-drifting dimension. Ranges from 0 (no periodic pattern) to 1 (perfect periodicity).</li>
<li><strong>Max absolute slope:</strong> the maximum of <code>|linear_trend__attr_slope|</code> across all dimensions, including drifting ones.</li>
</ul>
<p>The tiers are checked in order. Each trajectory starts labeled as "chaos" and the first matching tier overwrites that label. Trajectories already claimed by an earlier tier are skipped by later ones.</p>
<p><strong>Fixed Point (FP):</strong></p>
<div class="arithmatex">\[\text{variance} &lt; \texttt{fp_variance_threshold}\]</div>
<p>A trajectory whose steady-state variance falls below <code>fp_variance_threshold</code> (default <code>1e-6</code>) has settled to a constant value. For unnormalized features from a well-converged integration, <code>1e-6</code> catches fixed points reliably.</p>
<p><strong>Limit Cycle (LC):</strong> A trajectory is classified as LC if either condition holds:</p>
<ol>
<li><em>Periodic oscillation:</em> periodicity strength <span class="arithmatex">\(&gt;\)</span> <code>lc_periodicity_threshold</code> AND variance <span class="arithmatex">\(&lt;\)</span> <code>chaos_variance_threshold</code></li>
<li><em>Rotating solution:</em> max |slope| <span class="arithmatex">\(&gt;\)</span> <code>drift_threshold</code> AND variance <span class="arithmatex">\(&gt;\)</span> <code>fp_variance_threshold</code></li>
</ol>
<p>The first condition captures standard limit cycles -- regular oscillations with strong periodicity and bounded amplitude. The <code>chaos_variance_threshold</code> (default <code>5.0</code>) serves as the upper bound here: a trajectory with high periodicity <em>but</em> extremely large variance is more likely chaotic than a clean limit cycle, so it gets excluded. The second condition catches rotating solutions (e.g., a pendulum spinning over the top) where the angle drifts monotonically but the trajectory is still periodic in a phase-space sense. The lower bound <code>variance &gt; fp_variance_threshold</code> prevents fixed points from being misclassified as rotating LCs.</p>
<p><strong>Chaos:</strong> Everything not matched by FP or LC remains labeled "chaos." Typically these trajectories have high variance combined with low periodicity strength. Note that "chaos" here is a catch-all for non-FP, non-LC behavior -- it will also capture unbounded trajectories unless those are handled separately (see <a href="../../api/predictors/"><code>UnboundednessMetaEstimator</code></a>).</p>
<p>Because tiers are checked in order, the ordering matters. With <code>tiers=["LC", "FP"]</code>, a trajectory with both near-zero variance and high periodicity would be labeled LC, not FP.</p>
<h3 id="stage-2-sub-classification">Stage 2: Sub-classification</h3>
<p>After Stage 1, each attractor type may contain multiple distinct attractors. This stage separates them. The labeling is sequential across all types -- if FP sub-classification produces labels 0 and 1, the first LC sub-cluster starts at label 2. This gives globally unique labels like <code>FP_0</code>, <code>FP_1</code>, <code>LC_2</code>, <code>LC_3</code>.</p>
<h4 id="fixed-point-sub-classification">Fixed Point Sub-classification</h4>
<p>Fixed points are clustered by their steady-state location, using the <code>mean</code> feature across non-drifting dimensions.</p>
<p>Before running any clustering, the algorithm checks whether the data range (max - min) of mean values in every dimension falls below 0.01. If so, all trajectories go into a single cluster -- this avoids spurious splits when all fixed points converge to the same location.</p>
<p>Otherwise, HDBSCAN runs on StandardScaler-normalized mean values with <code>min_cluster_size = max(50, n // 10)</code>, where <code>n</code> is the number of FP trajectories. Noise points are assigned to their nearest cluster via the <code>assign_noise=True</code> behavior in pyBasin's HDBSCAN wrapper.</p>
<p>A custom sub-classifier can replace this step via <code>fp_sub_classifier</code>. It receives a feature matrix with one row per fixed-point trajectory and one column per non-drifting dimension, containing the mean values.</p>
<h4 id="limit-cycle-sub-classification">Limit Cycle Sub-classification</h4>
<p>Limit cycles use a hierarchical two-level approach:</p>
<p><strong>Level 1 -- Period grouping:</strong> The <code>spectral_frequency_ratio</code> is rounded to the nearest integer (clamped to [1, 10]) to determine the period number. Period-1, period-2, etc. trajectories form separate groups. This step uses a single analysis dimension -- the first non-drifting dimension.</p>
<p><strong>Level 2 -- Within-period clustering:</strong> Inside each period group, the algorithm checks whether amplitude and mean values vary enough to warrant splitting:</p>
<ul>
<li><em>Amplitude variation</em> is measured by the coefficient of variation (CV = std/mean). If CV <span class="arithmatex">\(&gt; 0.1\)</span>, amplitude varies meaningfully.</li>
<li><em>Mean variation</em> is measured by the range (max - min). If range <span class="arithmatex">\(&gt; 0.05\)</span>, spatial location varies.</li>
</ul>
<p>When neither varies, the whole period group becomes one cluster. When one or both vary, the variable features are passed to a gap-based 1D clusterer (for a single varying feature) or to HDBSCAN (for two varying features). The 1D gap detector sorts values and finds gaps <span class="arithmatex">\(&gt;5\times\)</span> the median spacing, creating up to 5 clusters.</p>
<p>A custom sub-classifier can replace the entire two-level process via <code>lc_sub_classifier</code>. It receives <code>[freq_ratio, amplitude, mean]</code> columns from the first analysis dimension.</p>
<h4 id="chaos-sub-classification">Chaos Sub-classification</h4>
<p>Chaotic attractors are clustered by their spatial mean across non-drifting dimensions, using <code>HDBSCANClusterer</code> with <code>auto_tune=True</code>. Two butterfly wings of the Lorenz attractor, for instance, have different mean <span class="arithmatex">\(x\)</span>-values and will separate into <code>chaos_0</code> and <code>chaos_1</code>.</p>
<p>Non-finite values (e.g., from diverged trajectories) are zeroed before scaling. If fewer than 2 finite samples exist, everything goes into one cluster.</p>
<p>A custom sub-classifier via <code>chaos_sub_classifier</code> receives a matrix of mean values with one row per chaotic trajectory and one column per non-drifting dimension.</p>
<h2 id="constructor-parameters">Constructor Parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>drift_threshold</code></td>
<td><code>float</code></td>
<td><code>0.1</code></td>
<td>Minimum |slope| to flag a dimension as drifting. Units: state_units / time_units. Also the threshold for detecting rotating LC solutions.</td>
</tr>
<tr>
<td><code>drift_fraction</code></td>
<td><code>float</code></td>
<td><code>0.3</code></td>
<td>Minimum fraction of trajectories with high slope for a dimension to be flagged as drifting. 0.3 means 30% of trajectories must show drift.</td>
</tr>
<tr>
<td><code>tiers</code></td>
<td><code>list[str] \| None</code></td>
<td><code>["FP", "LC", "chaos"]</code></td>
<td>Attractor types to detect, in priority order. First match wins. Options: <code>"FP"</code>, <code>"LC"</code>, <code>"chaos"</code>. Set to e.g. <code>["FP", "LC"]</code> to skip chaos.</td>
</tr>
<tr>
<td><code>fp_variance_threshold</code></td>
<td><code>float</code></td>
<td><code>1e-6</code></td>
<td>Maximum variance for FP classification. For unnormalized features, set based on expected steady-state fluctuations.</td>
</tr>
<tr>
<td><code>fp_sub_classifier</code></td>
<td>sklearn estimator</td>
<td><code>None</code></td>
<td>Custom sub-classifier for FP. Receives mean values per non-drifting dimension. Must implement <code>fit_predict()</code>. Default: HDBSCAN.</td>
</tr>
<tr>
<td><code>lc_periodicity_threshold</code></td>
<td><code>float</code></td>
<td><code>0.5</code></td>
<td>Minimum periodicity strength [0--1]. 0.3--0.5 is weak/noisy, 0.5--0.8 is clear periodic, 0.8--1.0 is strong.</td>
</tr>
<tr>
<td><code>lc_sub_classifier</code></td>
<td>sklearn estimator</td>
<td><code>None</code></td>
<td>Custom sub-classifier for LC. Receives <code>[freq_ratio, amplitude, mean]</code> columns. Must implement <code>fit_predict()</code>. Default: hierarchical.</td>
</tr>
<tr>
<td><code>chaos_variance_threshold</code></td>
<td><code>float</code></td>
<td><code>5.0</code></td>
<td>Upper variance bound for the periodic-LC condition. Trajectories above this with low periodicity become chaos.</td>
</tr>
<tr>
<td><code>chaos_sub_classifier</code></td>
<td>sklearn estimator</td>
<td><code>None</code></td>
<td>Custom sub-classifier for chaos. Receives mean values per dimension. Must implement <code>fit_predict()</code>. Default: HDBSCAN with auto_tune.</td>
</tr>
</tbody>
</table>
<p>For the full API reference, including method signatures and attribute details, see the <a href="../../api/predictors/"><code>DynamicalSystemClusterer</code> API documentation</a>.</p>
<h2 id="tuning-tips">Tuning Tips</h2>
<p><strong>Start with defaults,</strong> then adjust based on the label distribution. If too many limit cycles are classified as chaos, lower <code>chaos_variance_threshold</code> or raise <code>lc_periodicity_threshold</code>. If fixed points are missed, increase <code>fp_variance_threshold</code>.</p>
<p><strong>Normalization matters.</strong> The variance threshold operates on the actual feature values. When using <a href="../../api/feature-extractors/"><code>TorchFeatureExtractor</code></a> with <code>normalize=True</code> (the default), steady-state variance is z-score normalized, so the raw threshold <code>1e-6</code> will not match. Either disable normalization for this workflow or increase the threshold to account for scaling.</p>
<p><strong>Inspect the tiers.</strong> If your system has no chaotic behavior, set <code>tiers=["FP", "LC"]</code> to avoid misclassifying noisy limit cycles as chaos. Conversely, <code>tiers=["chaos"]</code> skips structured classification entirely and just clusters everything by spatial location.</p>
<p><strong>Custom sub-classifiers.</strong> Each attractor type's Stage 2 step accepts a custom sklearn-compatible estimator. Pass any clusterer that implements <code>fit_predict()</code>. For example, use <code>KMeans(n_clusters=2)</code> as <code>fp_sub_classifier</code> if you know exactly how many fixed points exist.</p>
<p><strong>Handling unbounded trajectories.</strong> <code>DynamicalSystemClusterer</code> by itself does not distinguish divergent trajectories from chaotic ones -- both end up in chaos. To separate them, wrap it with <a href="../../api/predictors/"><code>UnboundednessMetaEstimator</code></a>, which detects unbounded solutions via a solver event function before the clusterer runs. The Lorenz case study uses this pattern.</p>
<h2 id="validation-results">Validation Results</h2>
<p>Each case study was run with initial conditions taken from MATLAB bSTAB ground truth CSVs. Predicted labels were mapped to ground truth labels via majority vote per cluster, and the Matthews Correlation Coefficient (MCC) was computed against 5,000--20,000 labeled samples per system. All runs used default clusterer parameters with unnormalized features.</p>
<table>
<thead>
<tr>
<th>System</th>
<th>N</th>
<th>Attractors found</th>
<th>MCC</th>
</tr>
</thead>
<tbody>
<tr>
<td>Duffing</td>
<td>10,000</td>
<td>5 limit cycles</td>
<td>0.9977</td>
</tr>
<tr>
<td>Friction</td>
<td>5,000</td>
<td>1 fixed point, 1 LC</td>
<td>1.0000</td>
</tr>
<tr>
<td>Pendulum</td>
<td>10,000</td>
<td>1 fixed point, 1 LC</td>
<td>1.0000</td>
</tr>
<tr>
<td>Lorenz</td>
<td>20,000</td>
<td>2 chaotic, 1 unbounded</td>
<td>0.9985</td>
</tr>
</tbody>
</table>
<p>Friction and pendulum achieve perfect classification -- the two attractor types (FP and LC) are cleanly separated by the variance and periodicity thresholds. Duffing is harder because it has five coexisting limit cycles of different periods, yet the hierarchical period-based sub-classification still reaches MCC 0.9977. For Lorenz, the two butterfly attractors overlap in feature space enough to produce a small number of mis-assignments between <code>chaos_0</code> and <code>chaos_1</code>, but overall accuracy remains high at 0.9985.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.action.view"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>